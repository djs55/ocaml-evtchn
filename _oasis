OASISFormat: 0.3
Name:        xen-evtchn
Version:     1.0.5
Synopsis:    Xen event channel bindings
Authors:     Vincent Hanquez, Anil Madhavapeddy, David Scott, Jonathan Ludlam
License:     ISC
Plugins:     META (0.3)
BuildTools:  ocamlbuild

Flag xenctrl
  Description:        build Unix userspace bindings
  Default:            false

Library evtchn
  Pack:               true
  CompiledObject:     best
  Path:               lib
  Findlibname:        xen-evtchn
  Modules:            Generation, S
  BuildDepends:       lwt, bigarray, sexplib.syntax

Library evtchn_inheap
  CompiledObject:     best
  Path:               inheap
  Findlibname:        inheap
  Findlibparent:      evtchn
  Modules:            Inheap_events
  BuildDepends:       xen-evtchn, lwt

Library evtchn_unix
  CompiledObject:     best
  Path:               unix
  Findlibname:        unix
  Findlibparent:      evtchn
  Modules:            Unix_events
  BuildDepends:       lwt.unix, xen-evtchn

Library evtchn_xen
  CompiledObject:     best
  Path:               xen
  Findlibname:        xen
  Findlibparent:      evtchn
  Modules:            Xen_events, Activations, Eventchn
  BuildDepends:       lwt, sexplib, xen-evtchn, lwt.syntax

Library evtchn_xenctrl
  Build$:             flag(xenctrl)
  CompiledObject:     best
  Path:               xenctrl
  Findlibname:        xenctrl
  Findlibparent:      evtchn
  Modules:            Xenctrl_events, Unix_activations, Eventchn
  CSources:           eventchn_stubs.c
  CCLib:              -L/usr/lib/xen-4.2/lib -lxenctrl
  CCOpt:              -Wno-unused-function -g -ggdb
  BuildDepends:       unix, lwt, lwt.unix, bigarray, xen-evtchn, lwt.syntax

Executable linking
  Build$:             flag(tests)&&flag(xenctrl)
  CompiledObject:     best
  Path:               lib_test
  MainIs:             main.ml
  Custom:             true
  Install:            false
  NativeOpt:          -dontlink unix
  BuildDepends:       xen-evtchn, xen-evtchn.xenctrl

Test portable
  Command:            ./main.native
  Run:                true

